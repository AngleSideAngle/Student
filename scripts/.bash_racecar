#!/bin/bash
# Establishes tools to easily communicate with a RACECAR

################################################################################
# Please replace the following lines with the header generated by the racecar
# setup tool, which you can find at
# https://matthewcalligaro.github.io/RacecarWebsite/scripts/tool_setup.html
################################################################################


RACECAR_ABSOLUTE_PATH="/home/evan/Documents/Clinic/MITLLRacecar2019-2020/MITLLRacecar2019-2020"
RACECAR_IP="192.168.1.200"
RACECAR_TEAM="evan"

################################################################################
# DO NOT MODIFY ANY CODE BEYOND THIS POINT
################################################################################

racecar() {
  local RACECAR_DESTINATION_PATH="~/Documents/""$RACECAR_TEAM"
  if [ $# -eq 2 ] && [ "$1" = "sync" ]; then
    local valid_command=false
    if [ "$2" = "library" ] || [ "$2" = "all" ]; then
      echo "Copying your local copy of the RACECAR library to your car ("$RACECAR_IP")..."
      scp -rp "$RACECAR_ABSOLUTE_PATH"/library racecar@"$RACECAR_IP":"$RACECAR_DESTINATION_PATH"
      valid_command=true
    fi
    if [ "$2" = "labs" ] || [ "$2" = "all" ]; then
      echo "Copying your local copy of the RACECAR labs to your car ("$RACECAR_IP")..."
      scp -rp "$RACECAR_ABSOLUTE_PATH"/labs racecar@"$RACECAR_IP":"$RACECAR_DESTINATION_PATH"
      valid_command=true
    fi
    if [ "$valid_command" = false ]; then
      echo "'"$2"' is not a recognized sync command.  Please enter one of the following:"
      echo "racecar sync labs"
      echo "racecar sync library"
      echo "racecar sync all"
    fi
  elif [ $# -eq 1 ] && [ "$1" = "connect" ]; then
    echo "Attempting to connect to RACECAR ("$RACECAR_IP")..."
    ssh -t racecar@"$RACECAR_IP" "cd "$RACECAR_DESTINATION_PATH" && bash"
  elif [ $# -eq 1 ] && [ "$1" = "setup" ]; then
    echo "Creating your team directory ("$RACECAR_DESTINATION_PATH") on your RACECAR..."
    ssh racecar@"$RACECAR_IP" mkdir -p "$RACECAR_DESTINATION_PATH"
    racecar sync all
  elif [ $# -eq 1 ] && [ "$1" = "test" ]; then
    echo "racecar tool set up successfully!"
    echo "  RACECAR_ABSOLUTE_PATH: "$RACECAR_ABSOLUTE_PATH
    echo "  RACECAR_IP: "$RACECAR_IP
    echo "  RACECAR_TEAM: "$RACECAR_TEAM
  else
    if [$# -eq 1 ] && [ "$1" = "help" ]; then
      echo "The racecar tool helps your computer communicate with your RACECAR"
    else
      echo "That was not a recognized racecar command."
    fi
    echo ""
    echo "Supported commands:"
    echo "  racecar setup: sets up your team directory on your car"
    echo "  racecar connect: connects to your car with ssh"
    echo "  racecar sync library: copies your local RACECAR library folder to your car with scp"
    echo "  racecar sync labs: copies your local RACECAR labs folder to your car with scp"
    echo "  racecar sync all: copies all local RACECAR files to you car with scp"
    echo "  racecar test: prints a message to check if the RACECAR tool was set up successfully"
    echo "  racecar help: prints this help message"
  fi
}

alias cd_racecar="cd "$RACECAR_ABSOLUTE_PATH"/labs"
